---
sidebar_position: 5
---

# Mental Models

Mental models are structured knowledge containers that give Hindsight agents a broader understanding of important topics. Instead of reasoning over raw memories alone, the agent builds and maintains synthesized knowledge about key people, projects, concepts, and decisions.

import CodeSnippet from '@site/src/components/CodeSnippet';

{/* Import raw source files */}
import mentalModelsPy from '!!raw-loader!@site/examples/api/mental-models.py';

---

## Mission: the foundation

Before using mental models, you must set a **mission** for the memory bank. The mission is a natural language description of what the agent is for:

<CodeSnippet code={mentalModelsPy} section="mm-set-mission-alt" language="python" />

The mission tells the agent:
- What topics are important to track
- How to interpret incoming information
- What kind of mental models to build automatically

**Note:** A mission is required to use mental models, but mental models themselves are optional. You can still use `reflect()` without setting a mission—the agent will reason over raw memories. Mental models add structured understanding on top.

---

## What's in a mental model

Each mental model contains:

- **Name**: Human-readable identifier ("Alice", "Tech Stack Decisions")
- **Description**: One-liner for quick scanning
- **Subtype**: How it was created (structural, emergent, pinned, learned, directive)
- **Observations**: List of beliefs with evidence
- **Version**: Current version number
- **Tags**: For scoped visibility (multi-user scenarios)

---

## Observations and evidence

Observations are the beliefs within a mental model. Each observation requires **exact quotes** from source memories.

An observation contains:

| Field | Type | Description |
|-------|------|-------------|
| `title` | string | Short summary (5-10 words) |
| `content` | string | Detailed explanation |
| `evidence` | array | Supporting quotes from memories |
| `trend` | string | new, strengthening, stable, weakening, stale |

Each evidence item includes:

| Field | Type | Description |
|-------|------|-------------|
| `memory_id` | string | Source memory ID |
| `quote` | string | Exact quote from memory |
| `relevance` | string | Why this supports the observation |
| `timestamp` | string | When the memory was created |

The system **verifies** that quoted text actually exists in the source memories, ensuring observations are always grounded in real data.

### Computed trends

Instead of numeric confidence values, mental models use computed trends based on evidence patterns:

- **new**: Recently formed, limited evidence
- **strengthening**: Recent evidence supports this observation
- **stable**: Consistent evidence over time
- **weakening**: Recent evidence contradicts or is absent
- **stale**: No recent evidence, may be outdated

Trends are determined by analyzing evidence timestamps and recency patterns.

---

## Five types of mental models

Mental models can be created through different pathways:

### 1. Structural (mission-derived)

Created automatically from the bank's mission statement. If your agent's mission is "Be a PM for the engineering team", Hindsight generates structural models for concepts any PM would need to track: Team Members, Sprint Goals, Technical Debt.

### 2. Emergent (data-discovered)

Created automatically when patterns emerge in the data. If "Alice" is mentioned frequently across many memories, Hindsight promotes her to a mental model and synthesizes observations about her.

### 3. Pinned (user-created)

Created explicitly by users for topics they want the agent to track:

<CodeSnippet code={mentalModelsPy} section="mm-pinned" language="python" />

Observations are generated by analyzing relevant memories during refresh.

### 4. Learned (agent-created)

Created by the reflect agent during reasoning when it identifies topics worth tracking long-term. As part of the agentic reflect loop, the agent considers whether a topic deserves deeper understanding going forward.

For example, if a user asks "What are customers saying about our new pricing?" and the agent finds scattered feedback, it might create a "Pricing Feedback" mental model to track systematically.

### 5. Directive (hard rules)

User-defined constraints that the agent must follow. Unlike other mental models, directives are never modified by the system:

<CodeSnippet code={mentalModelsPy} section="mm-directive" language="python" />

Directives are injected into the system prompt during reflect with a "(MANDATORY)" marker.

---

## How reflect uses mental models

The reflect agent is **agentic**—it actively explores and drills down into information as needed. When answering a query, the agent can:

1. **List mental models** to see what structured knowledge is available
2. **Read a mental model** to get synthesized observations about a topic
3. **Drill into evidence** by following an observation's source memories
4. **Expand to full context** by loading the original document chunk
5. **Create new mental models** via the `learn` tool when it discovers important patterns

The agent decides how deep to go based on the query—simple questions may only need mental model summaries, while complex decisions may require drilling down to source documents.

See [Reflect](./reflect) for more on how disposition and mental models work together.

---

## Refreshing mental models

Mental model refresh is **manual**—you decide when to update observations based on new memories:

<CodeSnippet code={mentalModelsPy} section="mm-refresh-simple" language="python" />

All refresh operations run asynchronously.

### Freshness check

Each mental model includes a `freshness` field:

<CodeSnippet code={mentalModelsPy} section="mm-freshness-check" language="python" />

Reasons for refresh:
- **never_refreshed**: Model was just created
- **new_memories**: New memories retained since last refresh
- **mission_changed**: Bank's mission was updated
- **disposition_changed**: Bank's disposition traits changed
- **directives_changed**: Directive mental models were modified

### The refresh process

When a mental model refreshes, it runs a multi-phase pipeline:

1. **Update existing**: Search for new supporting/contradicting evidence for current observations
2. **Seed**: Generate candidate new observations from recent memories
3. **Evidence hunt**: Find supporting/contradicting evidence for candidates
4. **Validate**: Verify exact quotes exist in source memories
5. **Merge**: Decide what to keep, remove, or merge

Each refresh creates a new version.

---

## Version history

Every refresh creates a new version, preserving full history:

<CodeSnippet code={mentalModelsPy} section="mm-versions-simple" language="python" />

This enables auditing how beliefs evolved over time.

---

## Tags and scoping

Mental models support tags for multi-user scenarios. Tags let you create separate sets of mental models within the same bank:

<CodeSnippet code={mentalModelsPy} section="mm-tags-scoping" language="python" />

When calling reflect with tags, both memories and mental models are filtered to that scope.

---

## Next steps

- [**Reflect**](./reflect) — How disposition and mental models work together
- [**Mental Models API**](./api/mental-models) — Full API reference
- [**Memory Banks**](./api/memory-banks) — Managing bank configuration
